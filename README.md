# Turms
Turms是一款完全免费开源、易于集群部署、健壮的、方便拓展且业务独立的Java即时通信服务端程序。

## 配套组合
①Turms服务端自定义插件实现接口

[turms-plugin](https://github.com/turms-im/turms-plugin)

②Turms服务端集群监控：

[turms-admin](https://github.com/turms-im/turms-admin)

③Turms客户端：

通讯能力库

[turms-client-js](https://github.com/turms-im/turms-client-js)

[turms-client-dart](https://github.com/turms-im/turms-client-dart)

界面组件

[turms-client-ui-flutter](https://github.com/turms-im/turms-client-ui-flutter)

## 主要特性

1. 功能完善性。Turms支持几乎所有商用即时通信产品所支持的即时通信相关功能，并且无业务功能的限制。
2. 功能拓展性。Turms同时支持三种拓展模式。配置参数；自定义Plugin插件；消息抄送。当然您也完全可以对源码进行修改。未来接入ElasticSearch集群部分就将基于Plugin实现。
3. 配置灵活性。Turms提供了上百个配置参数供用户定制，以满足各种即时通信场景。
4. 部署简易性。Turms集群中仅有Turms服务端节点，默认无需为第三方服务端部署服务器。
5. 集群健壮性。Turms服务端通过Hash Slot与选举算法来保证在部分集群节点宕机的情况下，Turms集群仍能正常运作。
6. 存储可靠性。在每个Turms节点服务器中，都搭配了CockRoachDB用于消息存储与容灾，即高效又可靠。
7. 运作高效性。Turms使用的所有通信数据均为Protobuf二进制数据。同时充分利用内存，通过本地缓存高效运作。
8. 业务可插拔性。Turms服务端集群独立于您的业务逻辑服务端。

## 功能列表（非完全）

1. 此功能列表参考了：网易云信、融云、腾讯云通讯等商用即时通信服务。Turms提供了几乎所有这些商业服务所提供的业务功能，并在一些方面更上一层楼。
2. 本功能列表仅为功能概述。如果您需要了解具体实现的参数配置、完整方案与原理，请查阅对应的Wiki内容。
3. 注意：Turms的功能配置参数极其自由，您甚至可以配置一个群组有10,000个用户，单个消息上限100MB，关闭大部分功能等等的配置，拓展将消息转发给所有的用户等等功能，Turms服务端不会干涉您满足任何的业务场景。
Turms只是为您提供了最通用的配置，如默认一个群的上限人数为500，单个消息最大可为1MB等等。
请记住：您的业务服务端、Turms服务端、Turms客户端，三者之间的关系。
4. 如果您未在此列表中找到您所需要的功能，请先检查是否您的需求仅需配置Turms参数即可实现。确认无法通过Turms配置参数实现后，请再在Issue区域提出。Turms会根据“性价比”进行评估，并尽可能满足您的需求。

### 多端登录

| **多端登录类型**                                             | 实现版本 |
| :----------------------------------------------------------- | :-----|
| 只允许一端的一个设备登录。iOS、Android、PC、Web 彼此互踢          | 0.8.0 |
| 只允许桌面与移动端的一个设备同时登录。登录桌面PC 与 Web 端互踢、移动 Android 和 iOS 端互踢 | 0.8.0 |
| 各端均可以有一个设备同时登录                                       | 0.8.0 |

### 消息类型

提醒：虽然Turms服务端默认支持传递图片、视频、文件等数据的功能，但并不推荐使用此实现方案。
推荐的实现方案是使用CDN技术，或采用未来Turms提供的小文件管理插件来部署与管理文件服务集群。

| **消息类型**       | **备注**                                                     | **实现版本**|
| :----------------- | :----------------------------------------------------------- | :--------|
| 文本消息           | 消息内容为普通文本                                           | 0.8.0 |
| 富文本消息         | 消息内容为普通文本与其他任何类型的消息                       | 0.8.0 |
| 图片消息           | 消息内容为图片 URL 地址、尺寸、图片大小、图片数据字节码等信息                | 0.8.0 |
| 语音消息           | 消息内容为语音文件的 URL 地址、时长、大小、格式等信息； 语音消息录制时长默认 120 秒，支持配置 | 0.8.0 |
| 视频消息           | 消息内容为语音文件的 URL 地址、时长、大小、格式等信息        | 0.8.0 |
| 文件消息           | 消息内容为文件的 URL 地址、大小、格式等信息，格式不限，默认最大支持 15 M，支持配置 | 0.8.0 |
| 地理位置消息       | 消息内容为地理位置标题、经度、纬度信息                       | 0.8.0 |
| 通知消息           | 主要用于群事件的通知和群组事件的通知，可选有无推送和通知栏提醒（此部分为客户端内容）   | 0.8.0 |
| 自定义消息         | 开发者自定义的消息类型，例如红包消息、石头剪子布等形式的消息 | 0.8.0 |
| 系统消息           | 以上所有消息类型均可作为系统消息使用| 0.8.0 |

### 消息功能

| **消息功能** | **说明**                                                     | **实现版本** |
| :----------- | :----------------------------------------------------------- | :--- |
| 离线消息     | 不在线时收到的消息，在下次登录时，会自动将离线期间收取（懒加载）的消息下发到客户端。  默认情况下，Turms服务端不会定时删除任何用户发送的任何类型的消息 | 0.8.0 |
| 漫游消息     | 在新设备登录时，将服务器记录的漫游消息同步下来。 默认同步最近 7 天的所有消息（懒加载） | 0.8.0 |
| 多端同步     | 多客户端同时在线时，消息实时下发到多端                       | 0.8.0 |
| 历史消息     | 支持本地历史消息和云端历史消息。 默认存储最近1年的云端历史消息 | 0.8.0 |
| 消息撤回     | 撤回投递成功的消息，默认允许撤回距投递成功时间 2 分钟内的消息 | 0.8.0 |
| 已读回执     | 查看私聊、群组会话中对方的已读未读状态                           | 0.8.0 |
| 消息转发     | 将消息转发给其他用户或群组                                   | 0.8.0 |
| @某人        | 用于特别提醒某人的意思，被@的人会收到特别提醒的通知 | 0.8.0 |
| 正在输入     | 当通信中的一方正在键入文本时，告知收信人（一名或多名用户），该用户正在输入消息 | 0.8.0 |

### 用户关系托管

注意：在Turms中，某用户的联系人可以是被其加入黑名单的用户。联系人仅用于表示该用户所拥有的“联系人”这一概念，而不指代其间的其他关系。

| **功能**                 | **功能描述**                                                 | **实现版本** |
| :----------------------- | :----------------------------------------------------------- |:----------------------------------------------------------- |
| 添加联系人                 | 支持直接添加为联系人或发起联系人验证请求                        | 0.8.0 |
| 通过/拒绝联系人请求        | 收到请求添加联系人请求的系统通知后，可以通过或者拒绝             | 0.8.0 |
| 删除联系人                 | 默认情况下，删除联系人后，双方依然可以发送消息 |  0.8.0 |
| 联系人列表                 | 用户的通讯录 | 0.8.0 |
| 加入黑名单               | 将用户加入黑名单后，将不再收到对方发来的任何消息或者请求     | 0.8.0 |
| 移出黑名单               | 将用户移出黑名单                                             | 0.8.0 |
| 黑名单列表               | 获取黑名单列表                                               | 0.8.0 |
| 判断用户是否被拉进黑名单 | 判断用户是否在自己的黑名单内                                 | 0.8.0 |

### 群组功能

| **功能**         | **功能描述**                                                   | **实现版本** |
| :--------------- | :----------------------------------------------------------- | :--- |
| 群容量           | 默认群组上线人数为 500 人/群         | 0.8.0 |
| 创建             | 创建时指定群组类型                                           | 0.8.0 |
| 群资料属性       | 群名，群头像，群简介，群公告，群扩展字段， 申请加入群组的验证模式，群邀请模式，群被邀请模式， 群资料修改模式，群资料扩展字段修改模式 | 0.8.0 |
| 邀请入群         | 支持配置：仅管理员可邀请 、 所有人可邀请                     | 0.8.0 |
| 被邀请人同意模式 | 支持配置：需要被邀请人同意、不需要被邀请人同意               | 0.8.0 |
| 申请入群         | 支持                                                         | 0.8.0 |
| 入群验证         | 支持配置：需要管理员同意、不需要管理员同意、不允许任何人加入 | 0.8.0 |
| 群成员类型       | 群主、管理员、普通成员                                       | 0.8.0 |
| 管理员设置       | 群主可以增减管理员                                           | 0.8.0 |
| 群组资料修改权限 | 支持配置：仅管理员可修改、所有人可修改                      | 0.8.0 |
| 修改群成员昵称   | 群主可以修改所有人的群昵称。 管理员只能修改普通群成员的群昵称。 | 0.8.0 |
| 修改自己的群昵称 | 支持                                                         | 0.8.0 |
| 消息类型支持     | 同基础消息类型                                               | 0.8.0 |
| 消息提醒         | 接收提醒、只接收管理员消息提醒、不接收提醒                   | 0.8.0 |
| 历史消息         | 支持云端历史消息，默认服务端存储最近 1 年的历史记录 | 0.8.0 |
| 离线消息         | 每个群聊会话最多下发 500 条离线消息（懒加载）                         | 0.8.0 |
| 消息漫游         | 默认同步最近 7 天的所有消息（懒加载）                     | 0.8.0 |
| 指定成员强制推送 | 支持                                                         | 0.8.0 |
| 群消息已读回执   | 支持                  | 0.8.0 |
| 踢人             | 群主和管理员可以踢人，且管理员不能踢群主和其他管理员         | 0.8.0 |
| 主动退群         | 除群主外，其他用户均可以主动退群。 群主需先将群转让给其他群成员才可以进行退群操作 | 0.8.0 |
| 禁言             | 管理员对普通成员禁言、解除禁言                               | 0.8.0 |
| 转让群           | 群主可以将群的拥有者权限转给群内的其他成员，转移后， 被转让者变为新的群主，原群主变为普通成员。 群主还可以选择在转让的同时，直接退出该群。 | 0.8.0 |
| 解散群           | 群主可以解散群                                               | 0.8.0 |
| 修改群组开/关状态      | 修改群组开/关闭状态，仅支持从服务端修改                | 0.8.0 |
| 群组角色               | 创建者、管理员、普通成员、普通游客和匿名游客 | 0.8.0 |
| 群组黑名单             | 被拉黑后，将无法再进入群组                                 | 0.8.0 |
| 群组禁言               | 禁言用户可以在群组内，但无法发送消息                       | 0.8.0 |
| 群组临时禁言           | 群组支持设置临时禁言时长，禁言时长时间到了，自动取消禁言。 | 0.8.0 |
| 群组全员禁言           | 设置群组整体禁言状态，仅创建者和管理员能发言               | 0.8.0 |
| 群组机器人             | 往群组内批量添加、删除机器人          | 0.8.0 |

### 消息抄送

| **抄送类型**                   | **类型说明**                                                 |
| :----------------------------- | :----------------------------------------------------------- |
| 客户端转发消息抄送                   | 任何类型的客户端消息 |
| 服务端转发消息抄送                   | 任何类型的服务端消息 |
| 登录事件抄送                   | 用户登录事件的消息                                           |
| 登出事件抄送                   | 用户登出事件的消息                                           |

## 关键未来计划：
| **功能** | **说明** | **实现版本** |
| :---------------- | :------------------- | :---|
| 附近的人 | 附近的人 | 1.x |
| 用户消息查询 | （可选）通过TurmsClientMessagePlugin插件引入ElasticSearch集群用于用户消息查询 | 1.x |
| 分布式动态配置 | 分布式动态配置 | 1.x |
| 分布式动态配置 | 分布式动态配置 | 1.x |
| 文件集群管理 | 文件集群管理 | 2.x |
| 音频通话 | 音频通话 | 3.x |
| 视频通话 | 视频通话 | 3.x |
| 跨集群通信 | 跨集群通信 | x.x |
